(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{1223:function(e,t,n){"use strict";n.r(t);var o=n(28),r=n(8),a=n(10),c=n(11),l=n(12),s=n(6),i=n(0),u=n(1),d=n.n(u),p=n(14),b=n(26),h=n(62),f=n(5),O=n(15),m=n(29),j=function(e){return d.a.createElement(m.a,e,d.a.createElement("path",{d:"M17 6.998h3.018c1.098 0 1.975.89 1.982 2.002v10a1.993 1.993 0 0 1-1.987 2H3.98A1.983 1.983 0 0 1 2 19l.009-10.003c0-1.11.873-1.999 1.971-1.999L7 7V5c.016-1.111.822-2 2-2h6c.98 0 1.86.889 2 2v1.998zM9 7h6V5.5s0-.5-.5-.5h-5c-.504 0-.5.5-.5.5V7z",fillRule:"evenodd"}))};j.defaultProps={name:"Company"};var v=j,g=n(1591),w=n(156),M=n.n(w),y=n(317),k=n(174),C=n(87),S=n(205),R=n(290),N=n(239),B=n(145),T=n(2),U=n.n(T),x=n(7),E=n.n(x),F=n(16),P=n(86),A=n(1341),L=n(152),_=n(221),z=n(66),H=n(1275),q=n(38),G=n(1483),I=n(30);function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(s.a)(e);if(t){var r=Object(s.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(l.a)(this,n)}}var J=function(e){Object(c.a)(n,e);var t=V(n);function n(){var e;Object(r.a)(this,n);for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={modalShown:!1},e.handleSendMessage=function(){var t=e.props,n=t.onModalOpen,o=t.user.allowMessage,r=t.dispatch,a=t.doNotCheckAllowMessageSetting;o||void 0===o&&a?(e.setState({modalShown:!0}),n&&n()):r(Object(q.g)(I.K.blocked,"red")),O.a.trackEvent(Object(z.a)(e),{action:"Message",element:"Button",is_intent:!0})},e.handleCloseModal=function(){var t=e.props.onModalClose;e.setState({modalShown:!1}),t&&t()},e}return Object(a.a)(n,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.preset,o=e.color,r=e.icon,a=e.label,c=e.className,l=e.tooltip,s=e.tooltipPreset,u=e.authRequired,d=this.state.modalShown,p="3d198a56310c02c4a83efb9f4a4c027e"===t.id;return Object(i.c)(i.a,{children:[Object(i.b)(F.c,{preset:n,color:o,className:c,icon:r,label:a,onClick:u(this.handleSendMessage,p?I.M.serviceAccountMessage:I.M.message),"data-tooltip":l,"aria-label":l,"data-tooltip-preset":s}),Object(i.b)(G.a,{memberHashId:t.id,handleCloseModal:this.handleCloseModal,isModalShow:d})]})}}]),n}(u.Component);J.propTypes={onModalOpen:U.a.func,onModalClose:U.a.func},J.defaultProps={preset:"outline",color:"grey",icon:H.a,label:"发私信",doNotCheckAllowMessageSetting:!1};var K=Object(b.compose)(P.a,Object(p.connect)())(J),D=n(208);function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(s.a)(e);if(t){var r=Object(s.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(l.a)(this,n)}}var W=function(e){Object(c.a)(n,e);var t=Q(n);function n(){var e;Object(r.a)(this,n);for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={reportModalShown:!1},e.handleShieldUser=function(){var t=e.props,n=t.user.urlToken,o=t.updateUserBlocking,r=t.showNotification;o(n,!1).then((function(){return r("屏蔽已取消")}))},e}return Object(a.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.user,o=t.user,r=o.urlToken,a=o.isBlocking,c=o.isOrg,l=t.canShowMutualFollowStatus,s=t.className,u=t.buttonClassName,d=t.onModalOpen,p=t.onModalClose,b=t.authRequired,h=this.state.reportModalShown,f=E()("MemberButtonGroup",s);return a?Object(i.c)("div",{className:f,children:[Object(i.c)(F.c,{className:u,preset:"primary",color:"red",onClick:this.handleShieldUser,children:[Object(i.b)(A.a,{center:!0,text:!0})," 已屏蔽"]}),!c&&Object(i.c)(F.c,{className:u,onClick:b((function(){e.setState({reportModalShown:!0}),d&&d()}),I.M.report),children:["举报用户",Object(i.b)(_.a,{shown:h,onClose:function(){e.setState({reportModalShown:!1}),p&&p()},type:"member",urlToken:r,zaEnabled:!0})]})]}):Object(i.c)("div",{className:f,children:[Object(i.b)(L.a,{id:r,type:n.type,gender:n.gender,isFollowing:n.isFollowing,isFollowed:n.isFollowed,canShowMutualFollowStatus:l,className:u,preset:L.a.PRESETS.primary}),Object(i.b)(K,{user:n,className:u,onModalOpen:d,onModalClose:p})]})}}]),n}(u.Component);W.propTypes={user:U.a.object.isRequired,buttonClassName:U.a.string,onModalOpen:U.a.func,onModalClose:U.a.func};var X=Object(b.compose)(P.a,Object(p.connect)(null,{updateUserBlocking:D.j,showNotification:q.g}))(W);function Y(e){var t=this,n=e.user,o=e.user.isOrg,r=e.className,a=e.buttonClassName,c=e.onModalOpen,l=e.onModalClose,s=e.currentUser,u=e.authRequired,d=e.router,p=E()("ProfileButtonGroup",r);return s&&n.urlToken===s.urlToken?Object(i.b)("div",{className:p,children:Object(i.c)(F.c,{color:"blue",className:a,onClick:u((function(){O.a.trackEvent(t,{action:"OpenUrl",element:"Link"},{link:{url:"".concat(location.origin,"/people/edit")}}),d.push("/people/edit")}),I.M.editProfile),children:["编辑",o?"机构":"个人","资料"]})}):Object(i.b)(X,{user:n,canShowMutualFollowStatus:!0,className:p,buttonClassName:a,onModalOpen:c,onModalClose:l})}Y.propTypes={user:U.a.object.isRequired,buttonClassName:U.a.string,onModalOpen:U.a.func,onModalClose:U.a.func};var Z=Object(b.compose)(h.withRouter,P.a)(Y),$=n(486),ee=n(102),te=n(841),ne=n(840),oe=["toggler","user","id","urlToken","mutuals","onRef","currentUser"];function re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(s.a)(e);if(t){var r=Object(s.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(l.a)(this,n)}}var ae=function(e,t){return e.map((function(e){return t[e]})).slice(0,3)},ce=Object(C.isBrowser)()?M()(ae,(function(e,t){return"".concat(e.join(","),"-").concat(t.length)})):ae,le=[];var se=function(e){return Object(i.b)(f.Flex,Object.assign({css:{"&:not(:last-child)":{marginBottom:8}}},e))},ie=function(e){Object(c.a)(n,e);var t=re(n);function n(){var e;Object(r.a)(this,n);for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={isLoading:!1,childModalOpened:!1},e.loadUserProfile=function(){var t=e.props,n=t.id,o=t.urlToken;return(0,t.dispatch)(Object(D.h)(o||n,!1))},e.load=function(){var t=e.props,n=t.id;(t.urlToken||n)&&(e.setState({isLoading:!0}),e.loadUserProfile().then((function(){return e.setState({isLoading:!1})})),e.loadMutuals())},e.loadMutuals=function(){var t=e.props,n=t.user,o=t.dispatch,r=t.mutuals,a=void 0===r?[]:r,c=t.currentUser;return!a.length&&c&&n?o(Object(D.f)(n.urlToken,"mutuals")):Promise.resolve()},e.track=function(){var t=e.props.user;e.hoverCardElement&&t&&(O.a.setModule(e.hoverCardElement,{module:"UserItem"},{card:{content:{type:"User",member_hash_id:t.id}}}),O.a.trackCardShow(e.hoverCardElement))},e.handleOpen=function(){e.load(),e.track()},e}return Object(a.a)(n,[{key:"render",value:function(){var e,t,n=this,r=this.props,a=r.toggler,c=r.user,l=r.id,s=r.urlToken,u=r.mutuals,d=void 0===u?[]:u,p=r.onRef,b=r.currentUser,O=Object(o.default)(r,oe),m=c||{},j=m.isOrg,w=m.headline,M=m.avatarUrl,C=m.badge,B=m.badgeV2,T=m.answerCount,U=m.articlesCount,x=m.followerCount,E=m.employments,F=m.coverUrl,P=m.gender,A=m.isFollowed,L=m.isFollowing,_=this.state,z=_.isLoading,H=_.childModalOpened,q=d.length,G=Object(k.d)(B||C),V=G.bestAnswerer,J=G.identity,K="//www.zhihu.com/".concat(j?"org":"people","/").concat(s||l),D=b&&c&&b.urlToken===c.urlToken,Q=q>0&&!D,W=E&&E[0];if(null!=J&&J.length)t=Object(i.c)(se,{children:[Object(i.b)("a",{href:"".concat(I.w,"/account/verification/intro"),target:"_blank",rel:"noopener noreferrer",css:{marginRight:".3em"},children:Object(i.b)(k.a,{})}),Object(i.b)("div",{children:J.slice(0,2).map((function(e){return e.description})).join("，")})]});else if(W){var X=W.company,Y=W.job;t=Object(i.c)(se,{children:[(X||Y)&&Object(i.b)(f.Box,{as:"span",mr:".3em",color:"GBL05A",children:Object(i.b)(v,{text:!0,center:!0})}),Object(i.c)("div",{children:[X&&X.name,X&&Y&&Object(i.b)(f.Box,{display:"inline-block",width:"1px",height:"10px",mx:"8px",bg:"GBK09A"}),Y&&Y.name]})]})}else t=null;return Object(i.c)(R.b,Object.assign(Object.assign({toggler:a,onOpen:this.handleOpen,isLoading:z,globalClose:!H,stickHover:H,preventCloseOnTarget:!0},O),{},{onRef:function(e){p&&"function"==typeof p&&p(e),n.hoverCardElement=e},children:[Object(i.b)(R.a,{coverUrl:F,title:Object(i.c)("span",{css:{display:"flex"},children:[Object(i.b)($.a,{user:c,noHoverCard:!0}),Object(i.b)(ne.a,{isFollowed:A,isFollowing:L})]}),subtitle:w&&Object(i.b)(N.a,{inline:!0,html:w}),avatarUrl:M}),(t||V||Q)&&Object(i.c)("div",{children:[t,Boolean(null==V||null===(e=V.topics)||void 0===e?void 0:e.length)&&Object(i.c)(se,{children:[Object(i.b)("span",{css:{marginRight:".3em"},children:Object(i.b)(k.b,{})}),Object(i.c)("div",{children:[Object(i.b)(te.a,{expandable:!1,noHoverCard:!0,topics:V.topics,user:c}),"的优秀答主"]})]}),Q&&Object(i.c)(se,{color:"GBL05A",children:[Object(i.b)(f.Box,{mr:".3em",children:Object(i.b)(g.a,{text:!0,center:!0})}),Object(i.b)("div",{children:Object(i.c)(y.CJKSpace,{children:[d.map((function(e,t){return Object(i.c)(h.Link,{to:"//www.zhihu.com/".concat(j?"org":"people","/").concat(e.urlToken),target:"_blank",children:[e.name,t<q-1&&"、"]},t)})),"也关注了",I.E[P]]})})]})]}),Object(i.c)("div",{children:[Object(i.c)(S.a,{children:[Object(i.b)(S.a.Item,{tag:ee.a,preset:"plain",to:"".concat(K,"/answers"),name:"回答",value:T,target:"_blank"}),Object(i.b)(S.a.Item,{tag:ee.a,preset:"plain",to:"".concat(K,"/posts"),name:"文章",value:U,target:"_blank"}),Object(i.b)(S.a.Item,{tag:ee.a,preset:"plain",to:"".concat(K,"/followers"),name:"关注者",value:x,target:"_blank"})]}),c&&!D&&Object(i.b)(Z,{className:"HoverCard-buttons",user:c,onModalOpen:function(){n.hoverCardElement.style.opacity="0",n.setState({childModalOpened:!0})},onModalClose:function(){return n.setState({childModalOpened:!1})}})]})]}))}}]),n}(u.PureComponent);t.default=Object(b.compose)(B.a,Object(p.connect)((function(e,t){var n=t.id,o=t.urlToken,r=e.entities,a=e.people.mutualsByUser,c=r.users[o]||Object.values(r.users).find((function(e){return e.id===n}))||t.user,l=a[o||n]||{ids:le,isFetching:!1},s=l.ids,i=l.isFetching;return{user:c,mutuals:ce(s,r.users),isFetching:i}})))(ie)},1591:function(e,t,n){"use strict";var o=n(1),r=n.n(o),a=n(29),c=function(e){return r.a.createElement(a.a,e,r.a.createElement("path",{d:"M9.676 11.252c-.243.433-.542.85-.494 1.237.189 1.509 2.938 1.807 3.746 2.816.59.736.835 1.852.892 3.725.01.303 0 .97-.867.97H1.933c-.915 0-.925-.643-.915-.936.062-1.877.292-3.02.895-3.76.812-.994 3.743-1.267 3.872-2.872.03-.361-.246-.74-.493-1.18C3.917 8.802 3.39 4 7.466 4s3.506 4.941 2.21 7.252zm8.073.79l.002.641c1.57 1.766 4.47 1.307 4.851 3.166.125.61.328 1.538.384 3.232.009.284.014.919-.905.919-.92 0-5.523-.021-6.875-.019 0-2.806-.144-5.987-2.707-6.285.537-.331 1.725-.504 2.178-1.013l.002-.64c-.881.118-2.679-.541-2.679-.541.61-.64.747-1.387 1.192-4.317.355-2.93 2.835-2.903 3.022-2.903.187 0 2.667-.027 3.028 2.903.439 2.93.577 3.677 1.186 4.317 0 0-1.797.659-2.68.54z",fillRule:"evenodd"}))};c.defaultProps={name:"Users"},t.a=c}}]);
//# sourceMappingURL=column.user-hover-card.e59a9be449b413d0e1ba.js.map